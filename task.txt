4.d (65) Detecting contours of human organs in 3D CT images using the Canny edge detector (hint: link edges between image slices using 24-connectivity)

The image files, located in individual sub-folders of each patient of the CTMRI DB, show a certain part of the patient's body. Your task is to write a program for detecting contours of human organs in the 3D CT images from the CTMRI DB using the Canny edge detector. To fully complete the assignment you have to satisfy several requirements. The program has to accept the list of names of consecutive (neighboring) CT images from a sub-folder containing images of a certain part of the body of a patient (.png files of the database) as a parameter. The program has to detect edges in each image using the Canny edge detector. You have to determine both thresholds of the detector empirically. Then, the program has to perform edge linking in each image containing detected edges. (Instruction: during edge linking there is no need to calculate the gradient magnitude and angle arrays.) Finally, the program has to perform edge linking between consecutive images containing linked edges. (Instruction: link the edges between consecutive images using the 24-connectivity.) The output of the program is a sequence of binarized images after edge linking between consecutive images. Store the binarized output images into the .png files. The program has to display the sequence of the original images, the sequence of the images after edge linking and the sequence of the final images after edge linking between consecutive images. The program has to be tested using a sequence of at least 10 consecutive images of a certain part of the body of a patient from the CTMRI DB. Your discussions and conclusions regarding the use of the Canny edge detector for the task of edge detection in the 3D CT images have to be submitted in a document (.pdf) file. The .pdf file together with the source of your program has to be submitted during uploading the assignment. For 24-connectivity see below.



1. Prepare input handling
   1.1. Define a function that accepts a list of filenames (or full paths) of consecutive CT image slices from a single sub-folder.
   1.2. Ensure the list is ordered correctly (numerically by slice index).
   1.3. Verify that at least 10 consecutive images are provided for testing.

2. Load image data
   2.1. Load each .png CT image as a grayscale image.
   2.2. Store all images in a list or 3D array with shape (num_slices, height, width).

3. Determine Canny edge detector thresholds
   3.1. Select lower and upper Canny thresholds empirically by visual inspection.
   3.2. Keep the thresholds fixed for all slices in the sequence.
   3.3. Document the chosen threshold values for the report.

4. Perform Canny edge detection per slice
   4.1. Apply the Canny edge detector to each image independently.
   4.2. Store the resulting binary edge maps for all slices.

5. Perform 2D edge linking within each slice
   5.1. Take the binary edge map of each slice as input.
   5.2. Perform edge linking using pixel connectivity (e.g. 8-connectivity).
   5.3. Do not recompute gradient magnitude or gradient direction.
   5.4. Store the linked edge result for each slice.

6. Perform 3D edge linking between consecutive slices
   6.1. Treat the stack of 2D linked edge images as a 3D binary volume.
   6.2. For each edge pixel in slice k, examine neighboring pixels in slice k−1 and k+1.
   6.3. Use 24-connectivity for inter-slice linking (8 neighbors in slice k−1, 8 in slice k, 8 in slice k+1, excluding the center voxel).
   6.4. Link edges that are connected across slices according to this connectivity rule.
   6.5. Produce a final binary edge image for each slice after 3D linking.

7. Save output images
   7.1. Save the final binarized edge images (after 3D linking) as .png files.
   7.2. Use a clear naming scheme indicating slice index and processing stage.

8. Visualization
   8.1. Display the sequence of original CT images.
   8.2. Display the sequence after 2D edge linking (per slice).
   8.3. Display the sequence after 3D edge linking between consecutive slices.
   8.4. Ensure the display order matches the slice order.

9. Testing
   9.1. Run the program on at least 10 consecutive CT slices from one patient and body part.
   9.2. Verify visually that contours are continuous within slices and across slices.

10. Documentation and report
    10.1. Describe the implementation steps and parameter choices.
    10.2. Discuss the effectiveness of the Canny edge detector on 3D CT data.
    10.3. Analyze strengths and limitations (noise sensitivity, broken edges, slice spacing).
    10.4. Summarize conclusions and possible improvements.
    10.5. Save the discussion and conclusions in a .pdf file.

11. Submission
    11.1. Package the source code of the program.
    11.2. Include the generated .pdf report.
    11.3. Upload both as required for the assignment.
